# 実装計画

## 完了済みタスク

なし

## 実装タスク

- [x] 1. 共通型定義の作成
  - FileContentResponse、FileContentError、FileContentRequest型をsharedパッケージに追加
  - 既存のApiResponse形式と一貫性を保つ
  - _要件: 4.1, 4.2_

- [x] 2. FileContentServiceの実装（TDD）
  - ファイル内容取得機能の実装
  - 既存のisPathSafe()、getProjectById()関数の活用
  - エラーハンドリングの実装
  - _要件: 1.1, 1.2, 2.1, 2.2, 5.1, 5.2_

- [x] 3. APIエンドポイントの実装（TDD）
  - POST /api/projects/:id/files/contentエンドポイントの追加
  - Fastifyスキーマ定義の実装
  - FileContentServiceとの統合
  - _要件: 1.1, 1.3, 2.3_

- [x] 4. セキュリティテストの実装
  - パストラバーサル攻撃のテスト
  - 権限外ファイルアクセスのテスト
  - 不正なパラメータでのテスト
  - _要件: 5.3, 5.4_

- [x] 5. フロントエンドAPIクライアントの実装
  - getFileContent関数の実装
  - エラーハンドリング付きラッパー関数の実装
  - 既存のAPIクライアント形式との統合
  - _要件: 1.4, 2.4_

- [x] 6. 統合テストの実装
  - エンドツーエンドのAPIテスト
  - 正常系・異常系シナリオのテスト
  - レスポンス形式の検証
  - _要件: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 2.3, 2.4_

- [ ] 7. エラーハンドリングの強化
  - 詳細なエラーメッセージの実装
  - エラーコードとHTTPステータスの対応
  - ログ出力の実装
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [ ] 8. テキストファイル判定の実装
  - ファイル拡張子による判定
  - ファイル内容による判定（オプション）
  - バイナリファイル除外の実装
  - _要件: 3.1, 3.2, 3.3, 3.4_

- [ ] 9. パフォーマンステストの実装
  - 大きなファイルでの動作確認
  - 同時アクセス時の動作確認
  - メモリ使用量の確認
  - _要件: 3.3_
