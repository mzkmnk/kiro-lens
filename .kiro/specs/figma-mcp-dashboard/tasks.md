# 実装計画

- [ ] 1. プロジェクト初期セットアップとワークスペース構成
  - モノレポ構成でpackage.jsonワークスペース設定を作成
  - 各パッケージ（frontend、backend、shared）のディレクトリ構造とpackage.json設定
  - TypeScript設定ファイル（ルートとパッケージ別）の作成
  - _要件: 1.1, 1.2, 5.1_

- [ ] 2. 共通型定義とインターフェース実装
  - shared パッケージでファイルシステム、API、WebSocket の型定義を作成
  - FileTreeNode、FileContent、API レスポンス型の実装
  - WebSocket イベント型とエラー型の定義
  - _要件: 5.2_

- [ ] 3. CLI エントリーポイント実装
  - Commander.js を使用したCLIコマンド（kiro-lens）の実装
  - プロジェクトルート検出とサーバー起動ロジック
  - concurrently を使用したフロントエンド・バックエンド並行起動
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [ ] 4. Fastify バックエンドサーバー基盤実装
- [ ] 4.1 Fastify アプリケーション初期設定
  - Fastify サーバーインスタンス作成とプラグイン設定
  - CORS、WebSocket、静的ファイル配信の設定
  - エラーハンドリングミドルウェアの実装
  - _要件: 1.2, 5.4_

- [ ] 4.2 ファイルシステム API エンドポイント実装
  - GET /api/files でファイルツリー取得API作成
  - GET /api/files/:path でファイル内容取得API作成
  - PUT /api/files/:path でファイル更新API作成
  - _要件: 2.1, 4.2_

- [ ] 4.3 ファイル監視とWebSocket通信実装
  - chokidar を使用したファイル変更監視サービス作成
  - WebSocket サーバー実装とクライアント接続管理
  - ファイル変更イベントのWebSocket通知機能
  - _要件: 2.2, 2.3, 4.3_

- [ ] 5. Vite + React フロントエンド基盤実装
- [ ] 5.1 Vite プロジェクト設定とTailwind CSS統合
  - Vite 設定ファイル作成とReact + TypeScript環境構築
  - Tailwind CSS設定とFigmaデザインに対応したカスタムテーマ
  - 開発サーバー設定とプロキシ設定（バックエンドAPI用）
  - _要件: 3.4, 5.3_

- [ ] 5.2 React Query とWebSocket クライアント実装
  - React Query 設定とAPI状態管理の実装
  - Socket.io クライアント接続とリアルタイム更新フック作成
  - カスタムフック（useFiles、useWebSocket、useFileEditor）の実装
  - _要件: 2.3, 4.3, 5.3_

- [ ] 6. Figma UI コンポーネント実装
- [ ] 6.1 Dashboard レイアウトコンポーネント作成
  - Figmaデザインに基づくメインレイアウト（サイドバー、メインコンテンツ、タスクリスト）実装
  - レスポンシブデザイン対応とTailwind CSSクラス適用
  - プロジェクト名表示とブランチ情報表示機能
  - _要件: 3.1, 3.4_

- [ ] 6.2 Sidebar ファイルツリーコンポーネント実装
  - 階層ファイル構造の表示とフォルダ展開・折りたたみ機能
  - ファイル選択状態のハイライト表示
  - チェブロンアイコンの動的表示制御
  - _要件: 2.1, 3.2, 3.3_

- [ ] 6.3 MainContent ファイル表示・編集コンポーネント実装
  - ファイル内容表示とMarkdownレンダリング機能
  - インライン編集機能とリアルタイムプレビュー
  - 日本語フォント（Noto Sans JP）適用とスタイリング
  - _要件: 3.3, 3.4, 4.1_

- [ ] 6.4 TaskList コンポーネント実装
  - タスクアイテムの表示と展開・折りたたみ機能
  - チェックボックス状態管理と完了状態表示
  - タスク項目のクリックイベント処理
  - _要件: 3.5_

- [ ] 7. ファイル編集機能とリアルタイム同期実装
- [ ] 7.1 ファイル編集エディタ統合
  - テキストエディタコンポーネント（Monaco Editor または CodeMirror）統合
  - 編集モード切り替えとリアルタイムプレビュー機能
  - ファイル保存機能とAPI連携
  - _要件: 4.1, 4.2_

- [ ] 7.2 競合検出と解決機能実装
  - 複数クライアント間のファイル編集競合検出
  - ローカルファイル変更との競合検出機能
  - 競合解決UI（ローカル優先/ブラウザ優先/マージ選択）実装
  - _要件: 4.4, 4.5_

- [ ] 8. エラーハンドリングとパフォーマンス最適化
- [ ] 8.1 包括的エラーハンドリング実装
  - ファイルアクセスエラー、権限エラー、ネットワークエラーの処理
  - ユーザーフレンドリーなエラーメッセージ表示
  - WebSocket再接続機能とAPIリトライ機構
  - _要件: 2.5, 4.4_

- [ ] 8.2 パフォーマンス最適化実装
  - 大量ファイル表示時の仮想化（React Window）実装
  - React.memo、useMemo、useCallbackによるレンダリング最適化
  - ファイルメタデータキャッシュとメモリ管理最適化
  - _要件: 5.5_

- [ ] 9. テスト実装とドキュメント作成
- [ ] 9.1 ユニットテストとインテグレーションテスト作成
  - フロントエンドコンポーネントテスト（Vitest + React Testing Library）
  - バックエンドAPIテスト（Vitest + Supertest）
  - カスタムフックとサービス層のテスト実装
  - _要件: 全要件のテストカバレッジ_

- [ ] 9.2 E2Eテストと最終統合テスト
  - Playwright を使用したE2Eテストシナリオ作成
  - ファイル編集フロー全体のテスト実装
  - CLI起動からブラウザアクセスまでの統合テスト
  - _要件: 1.1, 1.2, 1.3, 2.2, 2.3, 4.1, 4.2_

- [ ] 10. 本番ビルドとデプロイメント準備
  - 本番用ビルド設定とアセット最適化
  - CLI パッケージング（npm publish 準備）
  - README.md とユーザーガイドドキュメント作成
  - _要件: 1.1, 1.3_