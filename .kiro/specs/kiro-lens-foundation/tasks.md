# kiro-lens-foundation TDD実装計画

## 概要

このタスクリストは、kiro-lens-foundationスペックの実装計画です。基盤となるCLI機能、サーバー構成、最小限のUI表示機能をTDD（テスト駆動開発）で実装し、後続スペックの土台となる動作する最小限のシステムを構築します。

## 完了済みタスク

- [x] 1. プロジェクト初期セットアップとワークスペース構成
  - モノレポ構成でpackage.jsonワークスペース設定を作成
  - 各パッケージ（frontend、backend、shared）のディレクトリ構造とpackage.json設定
  - TypeScript設定ファイル（ルートとパッケージ別）の作成
  - _要件: 2.1, 4.1_

## TDD実装タスク

- [x] 2. 共通型定義とポート管理型実装（TDD）
  - PortConfiguration、CLIOptions、PortValidationResult型のテスト作成と実装
  - shared パッケージでポート、ヘルスチェック、API の型定義を作成
  - 基本的なバリデーション関数とエラー型（FoundationErrorType）実装
  - 型安全性の強化とエクスポート構造の最適化
  - _要件: 4.1, 4.2, 1.3_

- [ ] 3. ポート管理システム実装（TDD）
  - 利用可能ポート検出機能のテスト作成と実装
  - ポート競合検出とランダムポート割り当て機能実装
  - 複数プロジェクト同時起動対応のPortManager実装
  - ポート検出アルゴリズムの最適化とエラーハンドリング改善
  - _要件: 1.1, 1.3, 5.1, 5.2_

- [ ] 4. CLI エントリーポイント実装（TDD）
  - Commander.js CLIコマンドの動作テスト作成と実装
  - コマンドライン引数解析とオプション処理機能実装
  - ヘルプメッセージ、バージョン表示、エラーハンドリング実装
  - ユーザビリティ向上とログ出力機能の改善
  - _要件: 1.1, 1.2, 1.4_

- [ ] 5. Fastify バックエンドサーバー基盤実装（TDD）
  - Fastify サーバー起動・停止とCORS設定のテスト作成と実装
  - 基本的なFastify設定、プラグイン、エラーハンドリング実装
  - 指定ポートでの起動機能とサーバー設定の外部化
  - ログ設定とプラグイン構造の整理・最適化
  - _要件: 2.3, 2.4, 2.5_

- [ ] 6. ヘルスチェックAPI実装（TDD）
  - GET /api/health エンドポイントのテスト作成と実装
  - HealthResponse型のレスポンスとサーバー状態確認機能実装
  - アップタイム計測とパフォーマンス監視機能実装
  - ヘルスチェック項目の拡張とレスポンス形式の最適化
  - _要件: 2.5, 3.5_

- [ ] 7. プロジェクト情報API実装（TDD）
  - GET /api/project エンドポイントのテスト作成と実装
  - .kiroディレクトリ検出とプロジェクト名取得機能実装
  - 基本的なプロジェクト情報レスポンスとエラーハンドリング実装
  - プロジェクト情報の詳細化とキャッシュ機能の追加
  - _要件: 3.2, 3.4_

- [ ] 8. Vite + React フロントエンド基盤実装（TDD）
  - Vite設定とReact + TypeScript環境のテスト作成と構築
  - Tailwind CSS v4統合と開発サーバー起動機能実装
  - ビルド設定の最適化と開発体験向上（HMR、エラー表示等）
  - アセット管理の改善とパフォーマンス最適化
  - _要件: 2.2, 3.1_

- [ ] 9. Tailwind CSS v4 + shadcn/ui セットアップ（TDD）
  - Tailwind CSS v4設定ファイルと日本語フォント（Noto Sans JP）統合
  - カスタムテーマ設定とshadcn/ui初期化実装
  - 基本コンポーネント（Button、Card、Badge等）のインストールと設定
  - TypeScript型定義統合とアクセシビリティ設定の強化
  - _要件: 2.2, 3.1_

- [ ] 10. 基本API通信とヘルスチェック実装（TDD）
  - fetch APIラッパーとヘルスチェック通信のテスト作成と実装
  - useHealthカスタムフックと基本的なAPI通信機能実装
  - エラーハンドリングの改善とリトライ機能の追加
  - 型安全性の強化とパフォーマンス最適化
  - _要件: 2.4, 3.5_

- [ ] 11. Dashboard レイアウトコンポーネント実装（TDD）
  - 基本レイアウト構造とプロジェクト名表示のテスト作成と実装
  - ヘッダー・サイドバー・メインコンテンツ構造とレスポンシブデザイン実装
  - レイアウトの最適化とアクセシビリティ改善
  - スタイリングの統一とパフォーマンス最適化
  - _要件: 3.1, 3.2_

- [ ] 12. Header コンポーネント実装（TDD）
  - プロジェクト名表示と接続状態インジケーターのテスト作成と実装
  - ヘッダーレイアウトとステータス表示機能実装
  - ビジュアルデザインの改善とインタラクティブ要素の追加
  - アニメーション効果とスタイリングの最適化
  - _要件: 3.2, 3.5_

- [ ] 13. Sidebar コンポーネント実装（TDD）
  - .kiroディレクトリ表示とディレクトリ未存在時のメッセージ表示テスト作成と実装
  - サイドバーレイアウトと.kiroディレクトリ存在確認機能実装
  - 基本的なファイルアイコン表示とビジュアルデザインの改善
  - アイコンとスタイリングの統一、将来の拡張性を考慮した構造改善
  - _要件: 3.3, 3.4_

- [ ] 14. MainContent コンポーネント実装（TDD）
  - 基本コンテンツ表示とウェルカムメッセージ表示のテスト作成と実装
  - .kiroディレクトリ未存在時のメッセージと条件分岐による表示切り替え実装
  - コンテンツレイアウトの改善と情報表示の充実
  - 将来の機能拡張を考慮した構造改善とパフォーマンス最適化
  - _要件: 3.1, 3.4_

- [ ] 15. サーバー起動統合機能実装（TDD）
  - CLI実行からサーバー起動までの統合テストとconcurrently による並行起動テスト作成
  - プロセス終了処理と基本的なプロセス管理機能実装
  - 起動プロセスの最適化とエラーハンドリングの改善
  - ログ出力とユーザビリティ向上、パフォーマンス最適化
  - _要件: 1.1, 1.5, 2.3_

- [ ] 16. エラーハンドリングとログ機能実装（TDD）
  - FoundationError型とポート競合エラーハンドリングのテスト作成と実装
  - ユーザーフレンドリーなエラーメッセージとログ出力機能実装
  - エラーメッセージの改善と復旧手順の提案機能追加
  - ログレベルとフォーマットの最適化、デバッグ機能強化
  - _要件: 1.3, 5.3_

- [ ] 17. 統合テストとE2E検証実装（TDD）
  - CLI実行からブラウザアクセスまでのE2Eテストと複数プロジェクト同時起動テスト作成
  - ポート指定オプションの動作テストとエンドツーエンドフローの動作確認
  - 基本的なユーザーシナリオの実装とテストの安定性向上
  - 包括的なテストカバレッジ確保とCI/CD統合準備
  - _要件: 1.1, 1.2, 5.1, 5.4_

- [ ] 18. ドキュメントとREADME作成
  - README.md作成（インストール、使用方法）とCLI使用方法のドキュメント作成
  - トラブルシューティングガイドと開発環境セットアップガイド作成
  - アーキテクチャ概要ドキュメントと次のスペック（kiro-lens-core-api）への接続ガイド作成
  - 基本的な使用方法ガイド、よくある質問（FAQ）、コミュニティ貢献ガイド作成
  - _要件: 1.1, 1.2, 1.3, 2.1, 4.5, 5.1_

## 完了基準

このスペックは以下の条件を満たした時点で完了とします：

### 機能的完了基準

- ✅ `npx kiro-lens` でランダムポートでサーバーが起動する
- ✅ `npx kiro-lens --port 3000` で指定ポートでサーバーが起動する
- ✅ ブラウザでダッシュボードにアクセスできる
- ✅ プロジェクト名と.kiroディレクトリ状態が表示される
- ✅ ヘルスチェックAPIが正常に動作する
- ✅ 複数プロジェクトで同時起動できる

### 技術的完了基準

- ✅ 全てのテストが通過する
- ✅ TypeScriptコンパイルエラーがない
- ✅ ESLintエラーがない
- ✅ 基本的なドキュメントが整備されている

### 品質基準

- ✅ テストカバレッジ80%以上
- ✅ 起動時間5秒以内
- ✅ メモリ使用量100MB以内
- ✅ 基本的なアクセシビリティ要件を満たす
