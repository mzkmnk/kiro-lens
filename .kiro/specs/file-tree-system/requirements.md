# 要件ドキュメント

## 概要

kiro-lensプロジェクトにおいて、選択されたプロジェクトの.kiro配下のファイル構造をサイドバーに階層表示し、ファイル選択機能を提供するファイルツリーシステムを実装します。現在「ファイルツリー機能は実装予定です」と表示されている部分を、実際に動作するファイルツリーコンポーネントに置き換え、ユーザーが.kiroディレクトリ内のファイルを視覚的に確認・選択できるようにします。

## 要件

### 要件1：.kiroファイルツリー取得API

**ユーザーストーリー:** 開発者として、選択されたプロジェクトの.kiro配下のファイル構造をAPIで取得し、フロントエンドで表示したい。

#### 受け入れ基準

1. WHEN バックエンドが`GET /api/projects/:id/files`リクエストを受信 THEN 指定されたプロジェクトの.kiroディレクトリのファイル構造を既存の`FileItem[]`型で返す
2. WHEN レスポンス形式 THEN 既存の`ApiResponse<FileItem[]>`形式を使用して一貫性を保つ
3. WHEN .kiroディレクトリが存在しない THEN 適切なエラーレスポンス（404）を返す
4. WHEN プロジェクトIDが無効 THEN 適切なエラーレスポンス（400）を返す
5. WHEN ファイル読み取り権限がない THEN 適切なエラーレスポンス（403）を返す

### 要件2：ファイルツリー表示コンポーネント

**ユーザーストーリー:** Kiro IDE利用者として、プロジェクトを選択した際に、そのプロジェクトの.kiro配下のファイル構造をサイドバーで階層表示で確認したい。

#### 受け入れ基準

1. WHEN プロジェクトが選択される THEN サイドバーに.kiroディレクトリのファイル構造が階層表示される
2. WHEN フォルダが存在する THEN フォルダアイコンと展開・折りたたみ機能が提供される
3. WHEN ファイルが存在する THEN ファイルアイコンとファイル名が表示される
4. WHEN ファイルツリーの読み込み中 THEN ローディング状態が表示される
5. WHEN ファイルツリーの読み込みに失敗 THEN エラーメッセージが表示される

### 要件3：ファイル選択機能

**ユーザーストーリー:** Kiro IDE利用者として、ファイルツリーからファイルをクリックして選択し、選択されたファイルが視覚的に識別できるようにしたい。

#### 受け入れ基準

1. WHEN ユーザーがファイルをクリック THEN そのファイルが選択状態になる
2. WHEN ファイルが選択される THEN 選択されたファイルがハイライト表示される
3. WHEN 別のファイルを選択 THEN 前の選択が解除され、新しいファイルが選択される
4. WHEN 選択されたファイル情報 THEN ダッシュボードのヘッダーにファイル名が表示される

### 要件4：既存システムとの統合と型安全性

**ユーザーストーリー:** 開発者として、ファイルツリー機能が既存のシステムと統合され、型安全で適切なエラーハンドリングを持つことで、保守性の高いコードを維持したい。

#### 受け入れ基準

1. WHEN ファイルツリーデータを扱う THEN 既存の`FileItem`型定義を再利用してTypeScriptの型安全性が保証される
2. WHEN APIクライアントを使用 THEN 既存の`ApiClient`クラスを拡張してファイルツリー取得メソッドを追加する
3. WHEN APIエラーが発生 THEN 既存のエラーハンドリング機構を使用して適切なエラーメッセージがユーザーに表示される
4. WHEN 予期しないエラーが発生 THEN アプリケーションがクラッシュせずに適切に処理される
